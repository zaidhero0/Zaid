The reason your script failed is that Windows 7 doesn't understand modern commands like New-LocalUser, Get-LocalUser, or Add-LocalGroupMember. Those were added in Windows 10. On Windows 7, your "Check My PC" workflow is trying to speak a language the PC hasn't learned yet.

To fix your YAML so it actually works on your Windows 7 Gaming PC, we need to use "Legacy" commands (net user and net localgroup).

The Fixed "Windows 7 Version" Workflow
Copy and paste this exact code. It replaces the broken modern commands with the ones Windows 7 actually understands:

YAML

name: Check My PC
on: workflow_dispatch
jobs:
  check:
    runs-on: self-hosted
    steps:
      - run: echo "My 32GB RAM PC is working!"
      - run: systeminfo

  secure-rdp:
    runs-on: self-hosted 
    timeout-minutes: 50000 

    steps:
      - name: 1. System and RDP Prep
        run: |
          # Enable RDP via Registry (Windows 7 way)
          reg add "HKLM\System\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
          reg add "HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
          
          # Open Firewall for RDP
          netsh advfirewall firewall add rule name="RDP-Port" dir=in action=allow protocol=TCP localport=3389

      - name: 2. Create User (Windows 7 Legacy Method)
        run: |
          # Use 'net user' because 'New-LocalUser' doesn't exist on Win7
          net user RDP Aa1!2345 /add /expires:never /passwordchg:no
          net localgroup Administrators RDP /add
          net localgroup "Remote Desktop Users" RDP /add
          echo "RDP_PASS=Aa1!2345" >> $env:GITHUB_ENV

      - name: 3. Setup Tailscale
        run: |
          # Windows 7 path is different, we'll check both
          $tsPath = "C:\Program Files\Tailscale\tailscale.exe"
          if (!(Test-Path $tsPath)) {
              $tsUrl = "https://pkgs.tailscale.com/stable/tailscale-setup-1.82.0-amd64.msi"
              Invoke-WebRequest -Uri $tsUrl -OutFile "ts.msi"
              Start-Process msiexec.exe -ArgumentList "/i", "ts.msi", "/quiet", "/norestart" -Wait
          }
          & "$tsPath" up --authkey=${{ secrets.TAILSCALE_AUTH_KEY }} --hostname=my-gaming-vps
          $tsIP = & "$tsPath" ip -4
          echo "TAILSCALE_IP=$tsIP" >> $env:GITHUB_ENV

      - name: 4. Persistent Loop
        run: |
          Write-Host "=== WINDOWS 7 VPS ACTIVE ==="
          Write-Host "Tailscale IP: $env:TAILSCALE_IP"
          Write-Host "User: RDP | Pass: Aa1!2345"
          while ($true) {
              Write-Host "[$(Get-Date)] Heartbeat: Gaming PC Online"
              Start-Sleep -Seconds 600
          }

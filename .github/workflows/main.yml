name: Gaming-Like Runner

on:
  workflow_dispatch:

jobs:
  gui-runner:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Update & Install Packages
        run: |
          sudo apt update -y
          sudo apt install -y xfce4 xfce4-goodies x11vnc xvfb mesa-utils htop

      - name: Start Virtual Display (Xvfb)
        run: |
          echo "Starting virtual display..."
          export DISPLAY=:99
          Xvfb :99 -screen 0 1280x720x24 &
          sleep 5

      - name: Start XFCE Desktop
        run: |
          echo "Starting XFCE desktop..."
          export DISPLAY=:99
          startxfce4 &
          sleep 5

      - name: Start VNC Server
        run: |
          echo "Starting VNC server..."
          x11vnc -display :99 -nopw -listen 0.0.0.0 -forever -shared &
          sleep 5

      - name: Show System Info
        run: |
          echo "CPU INFO:"
          lscpu
          echo "Memory:"
          free -h
          echo "Disk:"
          df -h

      - name: Keep Runner Alive
        run: |
          echo "Runner active..."
          for i in {1..60}; do
            echo "[$(date)] Runner alive..."
            sleep 30
          done

